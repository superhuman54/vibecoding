name: ðŸ’¬ PR ìžë™ ëŒ“ê¸€

on:
  pull_request:
    types: [opened, reopened]

jobs:
  pr-comment:
    name: PR ëŒ“ê¸€ ìž‘ì„±
    runs-on: ubuntu-latest
    
    steps:
    - name: PR í™˜ì˜ ëŒ“ê¸€ ìž‘ì„±
      uses: actions/github-script@v7
      with:
        script: |
          const { owner, repo } = context.repo;
          const prNumber = context.payload.pull_request.number;
          const author = context.payload.pull_request.user.login;
          
          const comment = `## ðŸŽ‰ PR ê²€í† ë¥¼ ì‹œìž‘í•©ë‹ˆë‹¤!

          ì•ˆë…•í•˜ì„¸ìš” @${author}ë‹˜! PRì„ ìƒì„±í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.
          
          ### ðŸ“‹ PR ì²´í¬ë¦¬ìŠ¤íŠ¸
          
          ë¦¬ë·°ì–´ëŠ” ë‹¤ìŒ ì‚¬í•­ë“¤ì„ í™•ì¸í•´ ì£¼ì„¸ìš”:
          
          - [ ] **ì½”ë“œ í’ˆì§ˆ**: ì½”ë“œê°€ í”„ë¡œì íŠ¸ ìŠ¤íƒ€ì¼ ê°€ì´ë“œë¥¼ ë”°ë¥´ëŠ”ê°€?
          - [ ] **í…ŒìŠ¤íŠ¸**: ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•˜ëŠ”ê°€?
          - [ ] **ê¸°ëŠ¥**: ë³€ê²½ì‚¬í•­ì´ ì˜ë„í•œ ëŒ€ë¡œ ë™ìž‘í•˜ëŠ”ê°€?
          - [ ] **ë¬¸ì„œ**: í•„ìš”í•œ ë¬¸ì„œ ì—…ë°ì´íŠ¸ê°€ í¬í•¨ë˜ì–´ ìžˆëŠ”ê°€?
          - [ ] **ì„±ëŠ¥**: ì„±ëŠ¥ì— ë¶€ì •ì ì¸ ì˜í–¥ì´ ì—†ëŠ”ê°€?
          - [ ] **ë³´ì•ˆ**: ë³´ì•ˆ ì·¨ì•½ì ì€ ì—†ëŠ”ê°€?
          
          ### ðŸ¤– ìžë™í™”ëœ ê²€ì‚¬
          
          - âœ… ìžë™ í…ŒìŠ¤íŠ¸ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤
          - âœ… ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬ê°€ ìˆ˜í–‰ë©ë‹ˆë‹¤
          - âœ… ë³´ì•ˆ ìŠ¤ìº”ì´ ì§„í–‰ë©ë‹ˆë‹¤
          
          ### ðŸ“Œ ì¶”ê°€ ì •ë³´
          
          - ë¦¬ë·°ê°€ ì™„ë£Œë˜ë©´ \`status/ready-for-review\` ë¼ë²¨ì´ ì¶”ê°€ë©ë‹ˆë‹¤
          - ë³€ê²½ ìš”ì²­ì´ ìžˆìœ¼ë©´ \`status/needs-changes\` ë¼ë²¨ì´ ì¶”ê°€ë©ë‹ˆë‹¤
          - ìŠ¹ì¸ í›„ ë©”ì¸ ë¸Œëžœì¹˜ë¡œ ìŠ¤ì¿¼ì‹œ ë¨¸ì§€ë©ë‹ˆë‹¤
          
          ì§ˆë¬¸ì´ë‚˜ ë„ì›€ì´ í•„ìš”í•˜ì‹œë©´ ì–¸ì œë“  ë©˜ì…˜í•´ ì£¼ì„¸ìš”! ðŸš€`;
          
          await github.rest.issues.createComment({
            owner,
            repo,
            issue_number: prNumber,
            body: comment
          });

  pr-size-comment:
    name: PR í¬ê¸° ë¶„ì„
    runs-on: ubuntu-latest
    
    steps:
    - name: ì½”ë“œ ì²´í¬ì•„ì›ƒ
      uses: actions/checkout@v4
      with:
        fetch-depth: 0
        
    - name: PR í¬ê¸° ë¶„ì„ ë° ëŒ“ê¸€
      uses: actions/github-script@v7
      with:
        script: |
          const { owner, repo } = context.repo;
          const prNumber = context.payload.pull_request.number;
          
          // PRì˜ ë³€ê²½ì‚¬í•­ ë¶„ì„
          const files = await github.rest.pulls.listFiles({
            owner,
            repo,
            pull_number: prNumber
          });
          
          let additions = 0;
          let deletions = 0;
          let fileCount = files.data.length;
          
          files.data.forEach(file => {
            additions += file.additions;
            deletions += file.deletions;
          });
          
          const totalChanges = additions + deletions;
          
          let sizeLabel = '';
          let sizeComment = '';
          
          if (totalChanges <= 50) {
            sizeLabel = 'size/XS';
            sizeComment = 'ðŸŸ¢ **ë§¤ìš° ìž‘ì€ PR**: ë¹ ë¥¸ ë¦¬ë·°ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤!';
          } else if (totalChanges <= 200) {
            sizeLabel = 'size/S';
            sizeComment = 'ðŸŸ¡ **ìž‘ì€ PR**: ì ì ˆí•œ í¬ê¸°ìž…ë‹ˆë‹¤.';
          } else if (totalChanges <= 500) {
            sizeLabel = 'size/M';
            sizeComment = 'ðŸŸ  **ì¤‘ê°„ í¬ê¸° PR**: ê¼¼ê¼¼í•œ ë¦¬ë·°ê°€ í•„ìš”í•©ë‹ˆë‹¤.';
          } else if (totalChanges <= 1000) {
            sizeLabel = 'size/L';
            sizeComment = 'ðŸ”´ **í° PR**: ë¦¬ë·°ì— ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.';
          } else {
            sizeLabel = 'size/XL';
            sizeComment = 'âš ï¸ **ë§¤ìš° í° PR**: ìž‘ì€ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ëŠ” ê²ƒì„ ê³ ë ¤í•´ë³´ì„¸ìš”.';
          }
          
          // í¬ê¸° ë¼ë²¨ ì¶”ê°€
          await github.rest.issues.addLabels({
            owner,
            repo,
            issue_number: prNumber,
            labels: [sizeLabel]
          });
          
          // í¬ê¸° ë¶„ì„ ëŒ“ê¸€ ìž‘ì„±
          const comment = `## ðŸ“Š PR í¬ê¸° ë¶„ì„

          ${sizeComment}
          
          **ë³€ê²½ í†µê³„:**
          - ðŸ“ íŒŒì¼ ìˆ˜: ${fileCount}ê°œ
          - âž• ì¶”ê°€ëœ ì¤„: ${additions}ì¤„
          - âž– ì‚­ì œëœ ì¤„: ${deletions}ì¤„
          - ðŸ“ ì´ ë³€ê²½: ${totalChanges}ì¤„
          
          ---
          _ìžë™ìœ¼ë¡œ ë¶„ì„ëœ ê²°ê³¼ìž…ë‹ˆë‹¤._`;
          
          await github.rest.issues.createComment({
            owner,
            repo,
            issue_number: prNumber,
            body: comment
          }); 