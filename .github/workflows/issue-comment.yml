name: ğŸ’¬ ì´ìŠˆ ìë™ ëŒ“ê¸€

on:
  issues:
    types: [opened, reopened]

jobs:
  welcome-comment:
    name: ì´ìŠˆ í™˜ì˜ ëŒ“ê¸€
    runs-on: ubuntu-latest
    
    steps:
    - name: ì´ìŠˆ í™˜ì˜ ëŒ“ê¸€ ì‘ì„±
      uses: actions/github-script@v7
      with:
        script: |
          const { owner, repo } = context.repo;
          const issueNumber = context.payload.issue.number;
          const author = context.payload.issue.user.login;
          const title = context.payload.issue.title;
          const body = context.payload.issue.body || '';
          
          // ì´ìŠˆ íƒ€ì… ë¶„ì„
          let issueType = 'ì¼ë°˜';
          if (title.toLowerCase().includes('[bug]') || title.toLowerCase().includes('bug')) {
            issueType = 'ë²„ê·¸ ë¦¬í¬íŠ¸';
          } else if (title.toLowerCase().includes('[feature]') || title.toLowerCase().includes('feature')) {
            issueType = 'ê¸°ëŠ¥ ìš”ì²­';
          } else if (title.toLowerCase().includes('[question]') || title.toLowerCase().includes('question')) {
            issueType = 'ì§ˆë¬¸';
          } else if (title.toLowerCase().includes('[enhancement]') || title.toLowerCase().includes('enhancement')) {
            issueType = 'ê°œì„  ì œì•ˆ';
          }
          
          const comment = `## ğŸ‘‹ ì´ìŠˆë¥¼ ë“±ë¡í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!

          ì•ˆë…•í•˜ì„¸ìš” @${author}ë‹˜! **${issueType}** ì´ìŠˆë¥¼ ì œì¶œí•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.
          
          ### ğŸ“‹ ì²˜ë¦¬ ì ˆì°¨
          
          1. **íŠ¸ë¦¬ì•„ì§€** (1-2ì¼): ì´ìŠˆ ë¶„ë¥˜ ë° ìš°ì„ ìˆœìœ„ ì„¤ì •
          2. **ë¶„ì„** (2-3ì¼): ê¸°ìˆ ì  ê²€í†  ë° êµ¬í˜„ ë°©ì•ˆ ë…¼ì˜  
          3. **í• ë‹¹** (1ì¼): ì ì ˆí•œ ë‹´ë‹¹ìì—ê²Œ í• ë‹¹
          4. **ê°œë°œ** (ì¼ì •ì— ë”°ë¼): ì‹¤ì œ ê°œë°œ ì‘ì—… ì§„í–‰
          5. **ê²€í†  ë° ë°°í¬**: ì½”ë“œ ë¦¬ë·° í›„ ë°°í¬
          
          ### ğŸ”„ ìƒíƒœ ê´€ë¦¬
          
          ì´ìŠˆëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë¼ë²¨ë¡œ ìƒíƒœê°€ ê´€ë¦¬ë©ë‹ˆë‹¤:
          - \`status/triage\`: ê²€í†  ëŒ€ê¸° ì¤‘
          - \`status/in-progress\`: ì‘ì—… ì§„í–‰ ì¤‘  
          - \`status/blocked\`: ì§„í–‰ ì°¨ë‹¨ë¨
          - \`status/ready\`: ì‘ì—… ì¤€ë¹„ ì™„ë£Œ
          
          ### ğŸ“ ì†Œí†µ ë°©ë²•
          
          - **ì§ˆë¬¸ì´ë‚˜ ì¶”ê°€ ì •ë³´ê°€ í•„ìš”í•˜ì‹œë©´** ì–¸ì œë“  ëŒ“ê¸€ë¡œ ì•Œë ¤ì£¼ì„¸ìš”
          - **ê¸´ê¸‰í•œ ë¬¸ì œë¼ë©´** \`priority/critical\` ë˜ëŠ” \`priority/high\` ë¼ë²¨ì´ ìë™ìœ¼ë¡œ ì ìš©ë©ë‹ˆë‹¤
          - **ì§„í–‰ ìƒí™©ì´ ê¶ê¸ˆí•˜ì‹œë©´** ë‹´ë‹¹ìë¥¼ ë©˜ì…˜í•´ ì£¼ì„¸ìš”
          
          ### ğŸ¤– ìë™í™” ì•ˆë‚´
          
          - âœ… ì´ìŠˆ íƒ€ì…ê³¼ ìš°ì„ ìˆœìœ„ê°€ ìë™ìœ¼ë¡œ ë¶„ì„ë©ë‹ˆë‹¤
          - âœ… ì ì ˆí•œ ë‹´ë‹¹ìê°€ ìë™ìœ¼ë¡œ í• ë‹¹ë©ë‹ˆë‹¤  
          - âœ… ê´€ë ¨ ë¼ë²¨ì´ ìë™ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤
          - âœ… ì§„í–‰ ìƒí™©ì´ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤
          
          **ë¹ ë¥¸ í•´ê²°ì„ ìœ„í•´ ìµœì„ ì„ ë‹¤í•˜ê² ìŠµë‹ˆë‹¤!** ğŸš€
          
          ---
          _ìë™ìœ¼ë¡œ ìƒì„±ëœ í™˜ì˜ ë©”ì‹œì§€ì…ë‹ˆë‹¤._`;
          
          await github.rest.issues.createComment({
            owner,
            repo,
            issue_number: issueNumber,
            body: comment
          });

  issue-template-check:
    name: ì´ìŠˆ í…œí”Œë¦¿ í™•ì¸
    runs-on: ubuntu-latest
    
    steps:
    - name: ì´ìŠˆ ë‚´ìš© ë¶„ì„
      uses: actions/github-script@v7
      with:
        script: |
          const { owner, repo } = context.repo;
          const issueNumber = context.payload.issue.number;
          const title = context.payload.issue.title;
          const body = context.payload.issue.body || '';
          
          let suggestions = [];
          let needsMoreInfo = false;
          
          // ë²„ê·¸ ë¦¬í¬íŠ¸ ì²´í¬
          if (title.toLowerCase().includes('bug') || title.toLowerCase().includes('[bug]')) {
            const bugRequiredFields = [
              { field: 'ì¬í˜„ ë‹¨ê³„', keywords: ['ì¬í˜„', 'reproduce', 'steps', 'step'] },
              { field: 'ì˜ˆìƒ ê²°ê³¼', keywords: ['ì˜ˆìƒ', 'expected', 'should'] },
              { field: 'ì‹¤ì œ ê²°ê³¼', keywords: ['ì‹¤ì œ', 'actual', 'but', 'however'] },
              { field: 'í™˜ê²½ ì •ë³´', keywords: ['í™˜ê²½', 'environment', 'version', 'os'] }
            ];
            
            bugRequiredFields.forEach(({ field, keywords }) => {
              const hasField = keywords.some(keyword => 
                body.toLowerCase().includes(keyword)
              );
              if (!hasField) {
                suggestions.push(`**${field}** ì •ë³´ë¥¼ ì¶”ê°€í•´ ì£¼ì„¸ìš”`);
                needsMoreInfo = true;
              }
            });
          }
          
          // ê¸°ëŠ¥ ìš”ì²­ ì²´í¬
          if (title.toLowerCase().includes('feature') || title.toLowerCase().includes('[feature]')) {
            const featureRequiredFields = [
              { field: 'ê¸°ëŠ¥ ì„¤ëª…', keywords: ['ê¸°ëŠ¥', 'feature', 'functionality'] },
              { field: 'ì‚¬ìš© ì‚¬ë¡€', keywords: ['ì‚¬ìš©', 'use case', 'scenario', 'ì‹œë‚˜ë¦¬ì˜¤'] },
              { field: 'ê¸°ëŒ€ íš¨ê³¼', keywords: ['íš¨ê³¼', 'benefit', 'impact', 'ê°œì„ '] }
            ];
            
            featureRequiredFields.forEach(({ field, keywords }) => {
              const hasField = keywords.some(keyword => 
                body.toLowerCase().includes(keyword)
              );
              if (!hasField) {
                suggestions.push(`**${field}** ì •ë³´ë¥¼ ì¶”ê°€í•´ ì£¼ì„¸ìš”`);
                needsMoreInfo = true;
              }
            });
          }
          
          // ì œëª©ì´ ë„ˆë¬´ ì§§ì€ ê²½ìš°
          if (title.length < 10) {
            suggestions.push('**ì œëª©ì„ ë” êµ¬ì²´ì ìœ¼ë¡œ** ì‘ì„±í•´ ì£¼ì„¸ìš” (ìµœì†Œ 10ì ì´ìƒ)');
            needsMoreInfo = true;
          }
          
          // ë‚´ìš©ì´ ë„ˆë¬´ ì§§ì€ ê²½ìš°
          if (body.length < 50) {
            suggestions.push('**ìƒì„¸í•œ ì„¤ëª…**ì„ ì¶”ê°€í•´ ì£¼ì„¸ìš” (ìµœì†Œ 50ì ì´ìƒ)');
            needsMoreInfo = true;
          }
          
          if (needsMoreInfo && suggestions.length > 0) {
            const comment = `## ğŸ“ ì´ìŠˆ ì‘ì„± ê°€ì´ë“œ

            ë” ë¹ ë¥´ê³  ì •í™•í•œ ì²˜ë¦¬ë¥¼ ìœ„í•´ ë‹¤ìŒ ì •ë³´ë¥¼ ì¶”ê°€í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤:
            
            ${suggestions.map((suggestion, index) => `${index + 1}. ${suggestion}`).join('\n')}
            
            ### ğŸ’¡ ì‘ì„± íŒ
            
            **ë²„ê·¸ ë¦¬í¬íŠ¸ì˜ ê²½ìš°:**
            - ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” êµ¬ì²´ì ì¸ ë‹¨ê³„
            - ìŠ¤í¬ë¦°ìƒ·ì´ë‚˜ ì—ëŸ¬ ë©”ì‹œì§€ (ìˆë‹¤ë©´)
            - ë¸Œë¼ìš°ì €, OS, ë²„ì „ ë“± í™˜ê²½ ì •ë³´
            
            **ê¸°ëŠ¥ ìš”ì²­ì˜ ê²½ìš°:**
            - ì–´ë–¤ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ëŠ”ì§€
            - êµ¬ì²´ì ì¸ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤
            - ìœ ì‚¬í•œ ê¸°ëŠ¥ì´ ìˆëŠ” ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ì°¸ê³  ì‚¬í•­
            
            **ì§ˆë¬¸ì˜ ê²½ìš°:**
            - ì‹œë„í•´ ë³¸ í•´ê²° ë°©ë²•ë“¤
            - ê´€ë ¨ ì½”ë“œë‚˜ ì„¤ì • ì •ë³´
            - ê¸°ëŒ€í•˜ëŠ” ê²°ê³¼
            
            ì¶”ê°€ ì •ë³´ë¥¼ ì œê³µí•´ ì£¼ì‹œë©´ ë” ì‹ ì†í•˜ê²Œ ë„ì›€ì„ ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸ™
            
            ---
            _ìë™ìœ¼ë¡œ ìƒì„±ëœ ê°€ì´ë“œì…ë‹ˆë‹¤._`;
            
            await github.rest.issues.createComment({
              owner,
              repo,
              issue_number: issueNumber,
              body: comment
            });
          }

  thank-you-comment:
    name: ê°ì‚¬ ë©”ì‹œì§€
    runs-on: ubuntu-latest
    if: github.event.action == 'opened'
    
    steps:
    - name: ì²« ê¸°ì—¬ì í™•ì¸ ë° ê°ì‚¬ ë©”ì‹œì§€
      uses: actions/github-script@v7
      with:
        script: |
          const { owner, repo } = context.repo;
          const issueNumber = context.payload.issue.number;
          const author = context.payload.issue.user.login;
          
          // ì‚¬ìš©ìì˜ ì´ì „ ì´ìŠˆ í™•ì¸
          const issues = await github.rest.issues.listForRepo({
            owner,
            repo,
            creator: author,
            state: 'all',
            per_page: 100
          });
          
          const userIssues = issues.data.filter(issue => 
            issue.user.login === author && issue.number !== issueNumber
          );
          
          if (userIssues.length === 0) {
            // ì²« ê¸°ì—¬ìì¸ ê²½ìš°
            const welcomeComment = `## ğŸ‰ ì²« ë²ˆì§¸ ì´ìŠˆë¥¼ í™˜ì˜í•©ë‹ˆë‹¤!

            @${author}ë‹˜, ì €í¬ í”„ë¡œì íŠ¸ì— ì²« ë²ˆì§¸ ì´ìŠˆë¥¼ ì œì¶œí•´ ì£¼ì…”ì„œ ì •ë§ ê°ì‚¬í•©ë‹ˆë‹¤! 
            
            ### ğŸŒŸ ì²« ê¸°ì—¬ì íŠ¹ë³„ ì•ˆë‚´
            
            - **ìš°ì„  ì²˜ë¦¬**: ì²« ê¸°ì—¬ìì˜ ì´ìŠˆëŠ” ìš°ì„ ì ìœ¼ë¡œ ê²€í† ë©ë‹ˆë‹¤
            - **ë©˜í† ë§**: í•„ìš”ì‹œ ìƒì„¸í•œ ê°€ì´ë“œì™€ ë„ì›€ì„ ì œê³µí•©ë‹ˆë‹¤
            - **ì»¤ë®¤ë‹ˆí‹°**: ì–¸ì œë“  ì§ˆë¬¸í•˜ê³  ì˜ê²¬ì„ ë‚˜ëˆ„ì–´ ì£¼ì„¸ìš”
            
            ### ğŸ“š ìœ ìš©í•œ ë¦¬ì†ŒìŠ¤
            
            - ğŸ“– [í”„ë¡œì íŠ¸ ë¬¸ì„œ](./README.md)
            - ğŸ¤ [ê¸°ì—¬ ê°€ì´ë“œ](./.cursor/rules/github-management.mdc)
            - ğŸ’¬ ì´ìŠˆë‚˜ PRì—ì„œ ì–¸ì œë“  ì§ˆë¬¸í•´ ì£¼ì„¸ìš”
            
            **í•¨ê»˜ ë©‹ì§„ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ì–´ ê°€ìš”!** âœ¨
            
            ---
            _ì²« ê¸°ì—¬ìë¥¼ ìœ„í•œ íŠ¹ë³„ ë©”ì‹œì§€ì…ë‹ˆë‹¤._`;
            
            await github.rest.issues.createComment({
              owner,
              repo,
              issue_number: issueNumber,
              body: welcomeComment
            });
          } else {
            // ê¸°ì¡´ ê¸°ì—¬ìì¸ ê²½ìš°
            const returnComment = `## ğŸ™Œ ë‹¤ì‹œ ë§Œë‚˜ì„œ ë°˜ê°‘ìŠµë‹ˆë‹¤!

            @${author}ë‹˜, ë˜ ë‹¤ë¥¸ ì†Œì¤‘í•œ ì´ìŠˆë¥¼ ì œì¶œí•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! 
            
            **ì´ì „ ê¸°ì—¬:** ${userIssues.length}ê°œì˜ ì´ìŠˆë¥¼ ì œì¶œí•´ ì£¼ì…¨ë„¤ìš”. 
            
            í•­ìƒ í”„ë¡œì íŠ¸ ê°œì„ ì— ê´€ì‹¬ì„ ê°€ì ¸ì£¼ì…”ì„œ ì •ë§ ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ¯
            
            ---
            _ê¸°ì¡´ ê¸°ì—¬ìë¥¼ ìœ„í•œ ê°ì‚¬ ë©”ì‹œì§€ì…ë‹ˆë‹¤._`;
            
            await github.rest.issues.createComment({
              owner,
              repo,
              issue_number: issueNumber,
              body: returnComment
            });
          } 